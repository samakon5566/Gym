@model IEnumerable<prjGymEndTerm.ViewModels.CLessonViewModel>

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="~/assets/vendor/bootstrap/css/bootstrap.min.css">
    <link href="~/assets/vendor/fonts/circular-std/style.css" rel="stylesheet">
    <link rel="stylesheet" href="~/assets/libs/css/style.css">
    <link rel="stylesheet" href="~/assets/vendor/fonts/fontawesome/css/fontawesome-all.css">
    <link rel="stylesheet" href="~/assets/vendor/charts/chartist-bundle/chartist.css">
    <link rel="stylesheet" href="~/assets/vendor/charts/morris-bundle/morris.css">
    <link rel="stylesheet" href="~/assets/vendor/fonts/material-design-iconic-font/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="~/assets/vendor/charts/c3charts/c3.css">
    <link rel="stylesheet" href="~/assets/vendor/fonts/flag-icon-css/flag-icon.min.css">

    <link rel="stylesheet" href="~/assets/vendor/perfect-scrollbar/perfect-scrollbar.css">
    <link rel="stylesheet" href="~/assets/libs/css/app.css">
    <link rel="stylesheet" href="~/assets/libs/css/bootstrap.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="~/assets/vendor/bootstrap-icons/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

</head>

<style>
    .coachTitle {
        position: absolute;
        width: 100%;
        text-align: center;
        font-weight: 800;
        /*margin:0 0 0 500px*/
    }

    #myTable {
        margin: 15px 0;
        /*border: 1px solid #D0D0D0;*/
        /*padding:10px 0 0 0*/
    }
    /*    tr {
            border-bottom: 2px solid gray;
        }*/
    th {
        text-align: center;
        width: 100px;
        /*background-color: #FBFBFF;*/
        height: 40px
    }

    .page-breadcrumb {
        margin: 60px 0 15px 0;
    }

    .breadcrumb-item {
        font-size: 15px
    }

    td {
        text-align: center;
    }

    .table {
        width: 1300px;
        border: 1px solid #D0D0D0;
        background-color: #FCFCFC
    }

    .backTh {
        width: 100px
    }

    .backCBody {
        padding: 50px 0 0 80px;
        width: 1280px
    }

    .frame {
        position: relative;
        display: flex;
        justify-content: space-between;
    }

    .form {
        display: inline;
        position: absolute;
        right: 0;
    }

    body {
        background-color: #efeff6
    }

    .divnone {
        height: 40px
    }

    .addbtn {
        margin: 10px 10px 0 0
    }

    .thCount {
        width: 7%
    }

    .thbtn {
        width: 15%
    }

    .th10 {
        width: 10%
    }

    .th5 {
        width: 5%
    }
</style>

<script src='//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js'></script>
<script src='//cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js'></script>
<link href='//cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css' rel='stylesheet' />

<input id="hdData" type="hidden" value="@ViewData["LESSON"]" />
<input id="hdLoad" type="hidden" onclick=" window.location.href='@Url.Content("~/Backstage/addLessonView")' " />

<div id="div">
    <div id="hd">
        <table id="myTable" class="display" style="width:1150px">
            <thead>
                <tr>
                    <th class="thCount">
                        序號
                    </th>
                    <th class="th10">
                        @Html.DisplayNameFor(model => model.CourseCategoryName)
                    </th>
                    <th class="th10">
                        @Html.DisplayNameFor(model => model.CourseDetailName)
                    </th>
                    <th class="thbtn">
                        @Html.DisplayNameFor(model => model.CourseClassName)
                    </th>
                    <th class="thbtn">
                        @Html.DisplayNameFor(model => model.CourseClassCoach)
                    </th>
                    <th class="th10">
                        @Html.DisplayNameFor(model => model.ClassroomName)
                    </th>
                    <th class="thbtn">
                        @Html.DisplayNameFor(model => model.LessonTime)
                    </th>
                    <th class="thCount">
                        刪除
                    </th>
                </tr>
            </thead>
            <tbody>
                @{
                    int count = 0;
                    foreach (var item in Model)
                    {
                        count++;
                        <tr>
                            <td>
                                @count
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.CourseCategoryName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.CourseDetailName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.CourseClassName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.CourseClassCoach)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ClassroomName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.LessonTime)
                            </td>
                            <td>
                                <a class="btn btn-rounded btn-danger" id="btnDelete"><i class="fas fa-trash-alt"></i></a>
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>
</div>


<script>
    $('#myTable').DataTable({
        language: {
            "emptyTable": "無資料...",
            "processing": "處理中...",
            "loadingRecords": "載入中...",
            "lengthMenu": "每頁 _MENU_ 筆資料",
            "zeroRecords": "無搜尋結果",
            "info": "_START_ 至 _END_ / 共 _TOTAL_ 筆",
            "infoEmpty": "尚無資料",
            "infoFiltered": "(從 _MAX_ 筆資料過濾)",
            "infoPostFix": "",
            "search": "搜尋:",
            "paginate": {
                "first": "首頁",
                "last": "末頁",
                "next": "下一頁",
                "previous": "上一頁"
            },
            "aria": {
                "sortAscending": ": 升冪",
                "sortDescending": ": 降冪"
            }
        }
    });
</script>

<script>

    $('#myTable>tbody').on('click', 'a:nth-child(1)', function () {

        const r = confirm('確定要刪除嗎?');

        if (r == true) {
            const SerialNumber = $(this).parents('tr').find('td:first-child').text();
            //alert(SerialNumber)
            const addLesson = $("#hdData").val();
            const addLessonJson = JSON.parse(addLesson); //轉換為json物件
            console.log(addLessonJson);

            const index = SerialNumber - 1;
            console.log(index)

            delete addLessonJson[index];
            console.log(JSON.stringify(addLessonJson))

            $.ajax({
                url: "/BackApi/editLessonToSession",
                type: "post",
                data: { jdata: JSON.stringify(addLessonJson) },
                success: function () {

                    // 創建事件物件
                    var evt = document.createEvent("HTMLEvents");
                    // 初始化
                    evt.initEvent("click", false, false);
                    //觸發事件
                    document.querySelector('#hdLoad').dispatchEvent(evt)
                },
                error: function () { alert("失敗！") }
            })

        }

    })
</script>

<script>

    function load() {
    // $('#hd').hide();
    //$('#div').load('@Url.Content("~/BackApi/addLessonView")')

    }


</script>



<!-- Optional JavaScript -->
<!-- jquery 3.3.1 -->
<script src="~/assets/vendor/jquery/jquery-3.3.1.min.js"></script>
<!-- bootstap bundle js -->
<script src="~/assets/vendor/bootstrap/js/bootstrap.bundle.js"></script>
<!-- slimscroll js -->
<script src="~/assets/vendor/slimscroll/jquery.slimscroll.js"></script>
<!-- main js -->
<script src="~/assets/libs/js/main-js.js"></script>
<!-- chart chartist js -->
<script src="~/assets/vendor/charts/chartist-bundle/chartist.min.js"></script>
<!-- sparkline js -->
<script src="~/assets/vendor/charts/sparkline/jquery.sparkline.js"></script>
<!-- morris js -->
<script src="~/assets/vendor/charts/morris-bundle/raphael.min.js"></script>
<script src="~/assets/vendor/charts/morris-bundle/morris.js"></script>
<!-- chart c3 js -->
<script src="~/assets/vendor/charts/c3charts/c3.min.js"></script>
<script src="~/assets/vendor/charts/c3charts/d3-5.4.0.min.js"></script>
<script src="~/assets/vendor/charts/c3charts/C3chartjs.js"></script>
<script src="~/assets/libs/js/dashboard-ecommerce.js"></script>

<script src="~/assets/vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
<script src="~/assets/libs/js/main-js.js"></script>